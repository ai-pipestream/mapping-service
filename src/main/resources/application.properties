# Application
quarkus.application.name=mapping-service

# Compose Dev Services - Use shared dev services via extension
%dev.quarkus.compose.devservices.enabled=true
%dev.quarkus.compose.devservices.files=${user.home}/.pipeline/compose-devservices.yml
%dev.quarkus.compose.devservices.project-name=pipeline-shared-devservices
%dev.quarkus.compose.devservices.start-services=true
%dev.quarkus.compose.devservices.stop-services=false
%dev.quarkus.compose.devservices.reuse-project-for-tests=true
%dev.quarkus.devservices.timeout=120s

# HTTP / gRPC Configuration
# Default to container-friendly port; dev overrides to avoid local port collisions.
quarkus.http.port=8080
quarkus.http.host=0.0.0.0
quarkus.http.root-path=/mapping
quarkus.grpc.server.use-separate-server=false
quarkus.grpc.server.enable-reflection-service=true
quarkus.grpc.server.max-inbound-message-size=2147483647
quarkus.grpc.clients."*".max-inbound-message-size=2147483647

# Development Configuration
%dev.quarkus.http.port=38104

# Test configuration
%test.quarkus.http.test-port=0

# Health
quarkus.smallrye-health.root-path=/health

# Service Registration Configuration
pipestream.registration.enabled=true
pipestream.registration.service-name=mapping-service
pipestream.registration.description=Document mapping and transformation service
pipestream.registration.type=SERVICE
pipestream.registration.advertised-host=${SERVICE_REGISTRATION_ADVERTISED_HOST:host.docker.internal}
pipestream.registration.advertised-port=${quarkus.http.port}
pipestream.registration.internal-host=${SERVICE_REGISTRATION_INTERNAL_HOST:172.17.0.1}
pipestream.registration.internal-port=${quarkus.http.port}
pipestream.registration.capabilities=document-mapping,text-transformation,grpc-mapping
pipestream.registration.tags=processing,documents,core-service
%test.pipestream.registration.enabled=false

# Registration service connection (platform-registration-service)
pipestream.registration.registration-service.host=localhost
pipestream.registration.registration-service.port=38101

# Quarkus Index Dependencies (required for CDI discovery in non-extension deps)
quarkus.index-dependency.pipestream-registration.group-id=ai.pipestream
quarkus.index-dependency.pipestream-registration.artifact-id=pipestream-service-registration
quarkus.index-dependency.pipestream-dynamic-grpc.group-id=ai.pipestream
quarkus.index-dependency.pipestream-dynamic-grpc.artifact-id=quarkus-dynamic-grpc

# Container Image Configuration
quarkus.container-image.registry=ghcr.io
quarkus.container-image.group=ai-pipestream
quarkus.container-image.name=mapping-service
quarkus.container-image.tag=latest
quarkus.container-image.additional-tags=${quarkus.application.version}

# Logging
quarkus.log.level=INFO
quarkus.log.category."ai.pipestream.service.mapping".level=DEBUG
